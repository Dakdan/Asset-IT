<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Admin Log</title>
<link rel="stylesheet" href="./css/style.css">
</head>

<body>
<h2>LOG ระบบ</h2>
<table border="1">
<thead>
<tr><th>เวลา</th><th>Action</th><th>User</th></tr>
</thead>
<tbody id="tb"></tbody>
</table>

<script>
const GAS_URL = 'YOUR_GAS_URL';
const admin = JSON.parse(localStorage.getItem('it_user'));

function jsonp(url, cb){
  const s=document.createElement('script');
  s.src=url+'&callback='+cb;
  document.body.appendChild(s);
  setTimeout(()=>s.remove(),3000);
}

jsonp(
  GAS_URL +
  '?action=getLogs' +
  '&admin=' + admin.userid,
  'render'
);

function render(res){
  if(!res.success) return;
  res.data.forEach(r=>{
    tb.innerHTML += `<tr>
      <td>${r.time}</td>
      <td>${r.action}</td>
      <td>${r.user}</td>
    </tr>`;
  });
}
</script>
</body>
</html>
