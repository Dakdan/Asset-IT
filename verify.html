<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô | IT Maintenance</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/ui.css">
</head>
<body>

<div class="login-wrapper">

  <div class="login-header">
    <div class="header-logo">
      <img src="https://img2.pic.in.th/-227e4f6f84f29f020.png">
    </div>
    <h2>‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∏‡∏î‡∏£‡∏ò‡∏≤‡∏ô‡∏µ</h2>
    <p>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</p>
  </div>

  <div class="login-card">
    <h3>üìß ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™</h3>

    <div class="form-group">
      <input id="email" placeholder="Email">
    </div>

    <div class="form-group">
      <input id="code" placeholder="Verification Code">
    </div>

    <button class="btn-login" onclick="verify()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
  </div>
</div>

<div id="overlay" class="overlay hidden">
  <div class="overlay-card">
    <div class="spinner"></div>
    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...</p>
  </div>
</div>

<div id="popup" class="popup hidden">
  <div class="popup-card">
    <h3 id="popupTitle"></h3>
    <p id="popupMsg"></p>
    <button onclick="closePopup()">‡∏ï‡∏Å‡∏•‡∏á</button>
  </div>
</div>

<script src="./js/api.js"></script>
<script src="./js/ui.js"></script>

<script>
const params = new URLSearchParams(location.search);
email.value = params.get('email') || '';

function verify() {
  showOverlay();
  callAPI('verify', {
    email: email.value,
    code: code.value
  }).then(res => {
    hideOverlay();
    if (res.ok) {
      showPopup('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
      setTimeout(()=>location.href='login.html',1500);
    } else {
      showPopup('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', res.message);
    }
  });
}
</script>

</body>
</html>
